#summary Описание плагина RSS

== Введение ==

Плагин предназначен для работы с [http://ru.wikipedia.org/wiki/Rss RSS-рассылками]. Интерфейсное решение (да и часть этой статьи) во многом скопировано с [http://www.utorrent.com/documentation/rss µTorrent]. 

== Использование ==

====Добавление рассылки====

Щелкните в любом месте на нижней части боковой панели, на надписи "Все рассылки", и выберите "Добавить рассылку" (либо просто нажмите кнопку RSS в главном меню). Введите в ячейку URL выбранной рассылки RSS и заполните поле "Метка", если вы хотите присвоить этой рассылке имя. 

Обратите внимание, что некоторые рассылки не имеют прямых ссылок на файлы .torrent. Такие рассылки нельзя использовать для автоматической загрузки через фильтры.

====Отключение рассылки====

Для отключения рассылки просто щелкните по ней правой кнопкой в списке категорий и выберите "Отключить рассылку". Если потребуется повторно активировать эту рассылку, просто щелкните ее еще раз правой кнопкой и выберите "Включить рассылку".

====Переименование рассылки====

Рассылку можно переименовать или изменить ее URL, щелкнув по ней один раз правой кнопкой мыши и выбрав "Правка рассылки".

====Просмотр RSS-рассылки====

Щелкните RSS-рассылку мышью для ее просмотра. Либо можно щелкнуть "Все рассылки". Все содержание, связанное с текущей рассылкой, будет показано в главном окне списка. По двойному щелчку на строке содержимого будет произведена попытка открытия соответствующего URL в браузере.

Для RSS-рассылок существуют дополнительные информационные колонки. Для их включения/отключения щелкните правой кнопкой на названии любой колонки. Порядок расположения колонок можно изменять, перетаскивая их мышью. Эти параметры не зависят от колонок, доступных при просмотре загруженных торрентов.

====Использование рассылок, требующих HTTP-аутентификации====

Если рассылки требуют HTTP-аутентификации, просто используйте следующий формат при вводе их URL: 
{{{
http://логин:пароль@некий-торрент-сайт.com/rss.php
}}}

====Использование рассылок, требующих cookies====

Для использования рассылок, требующих cookies, нужно найти cookies для сайта и взять оттуда требуемые (обычно они называются uid и pass).

    * Файлы cookies в Internet Explorer находятся в `%UserProfile%\Cookies`.
    * Пользователи Firefox могут найти файлы cookies в меню `Tools (Инструменты) -> Options (Настройки) -> Privacy (Приватность) -> Show Cookies (Показать cookies)`
    * Пользователи Opera могут найти файлы cookies в меню `Инструменты (Tools) -> Расширенные (Advanced) -> Cookies`.
    * Пользователям других браузеров следует обратиться к документации своей программы.
После нахождения всей требуемой информации введите URL рассылки в следующем формате:
{{{
http://некий-торрент-сайт.com/rss.php:COOKIE:name1=value;name2=value;
}}}
Альтернативный метод проинформировать ruTorrent о требуемых cookies предоставляет плагин [PluginCookies Cookies].

====Автоматическая загрузка торрентов====

Для автоматической загрузки торрентов Вы должны создать один или несколько фильтров.

    # Щелкните на любой рассылке правой кнопкой мыши и выберите в меню пункт "Менеджер рассылок". Откроется соотв. диалог.
    # Нажмите "Добавить", и введите в левой колонке имя добавляемого фильтра.
    # Введите содержимое фильтра в пункте Настройки фильтров -> Фильтр.

Содержимое фильтра должно представлять собой Perl-совместимое регулярное выражение ([http://www.pcre.org/ PCRE]). С синтаксисом PCRE можно ознакомиться, например, [http://ru.php.net/manual/en/reference.pcre.pattern.syntax.php здесь].

Это минимальный набор действий, требуемых для настройки автоматической загрузки. Остальные функции являются дополнительными и позволяют более полно контролировать процесс.

    * "Кроме": позволяет исключить определенные строки из совпадения. Например, вам не нужны версии с AC3-звуком и кодеком H.264: в разделе "Кроме:" вы можете написать {{{/(AC3|264)/i}}} для их исключения.
    * "Рассылка": позволяет выбрать рассылку, для которой будет применяться данный фильтр.
    * "Директория": позволяет выбрать директорию, в которую будут сохраняться торренты. 
    * "Не начинать закачку автоматически": используется для добавления всех загруженных торрентов в режиме "Остановлен". Загрузки будут добавлены в список, но скачивание начнется только после того, как вы вручную запустите их в списке торрентов.
    * "Метка": автоматическое назначение метки для торрентов, совпадающих с фильтром.
    * Для проверки параметров фильтра можно использовать кнопку "?". Если фильтр задан корректно, будет показано количество совпадений с ним в рассылке. Если нет - в логе ruTorrent Вы увидите соответствующее сообщение.

[http://rutorrent.googlecode.com/svn/wiki/images/rssdownloader.jpg]

== Как оно работает ==

После первой загрузки с установленным плагином RSS, ruTorrent выдает команду планировщику rTorrent, который, в свою очередь, начинает периодически опрашивать требуемые RSS-рассылки, сохраняя локальные копии их содержимого на диск. В процессе синхронизации он проверяет содержимое рассылок на предмет совпадения с имеющимися фильтрами. Если таковое имеется - соответствующие .torrent файлы передаются в rTorrent на обработку. Диагностика о неудачных загрузках и/или операциях синхронизации будет показана в окне лога ruTorrent при следующей загрузке последнего.

Еще раз обращаю внимание - процесс опроса начинается только после первой загрузки ruTorrent. Т.е. в промежуток между стартом rTorrent и первым после этого стартом ruTorrent никакой полезной работы производиться не будет. Чтобы избежать этого, нужно добавить в конфигурационный файл rTorrent специально обученную строчку (см. ниже).

== Дополнительная настройка плагина ==

Производится в файле `plugins/rss/rssconf.php`.
    * `$updateInterval` - переменная содержит интервал синхронизации локальных копий RSS-рассылок (в минутах). По умолчанию - 30 минут.
    * `$isAutoStart` - переменная определяет способ начала работы. Если она равна `true`, то команда планировщику rTorrent на начало работы выдается при загрузке ruTorrent. В противном случае Вы должны позаботиться о том, чтобы дать пинка планировщику самостоятельно. Для этого в файл конфигурации rTorrent нужно добавить строчку 
{{{
schedule = rss,0,00:30:00,"execute={sh,-c,php full_path_to_plugin/update.php& exit 0}"
}}}
 где full_path_to_plugin - полный путь к плагину RSS.