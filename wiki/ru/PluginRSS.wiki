----
= Плагин RSS =
----

<wiki:toc />

== Описание ==

Плагин предназначен для работы с [http://ru.wikipedia.org/wiki/Rss RSS-рассылками]. Интерфейсное решение (да и часть этой статьи) во многом скопировано с [http://www.utorrent.com/documentation/rss µTorrent]. 

== Использование ==

===Добавление рассылки===

Щелкните в любом месте на нижней части боковой панели, на надписи "Все рассылки", и выберите "Добавить рассылку". 

[http://rutorrent.googlecode.com/svn/wiki/ru/images/PluginRSS/addrssmenu.jpg]

Вы должны увидеть следующий диалог:

[http://rutorrent.googlecode.com/svn/wiki/ru/images/PluginRSS/addrss.jpg]

Введите в ячейку URL выбранной рассылки RSS и заполните поле "Метка", если Вы хотите присвоить этой рассылке имя.
Обратите внимание, что некоторые рассылки не имеют прямых ссылок на файлы .torrent. Такие рассылки нельзя использовать для автоматической загрузки через фильтры (по крайней мере, без применения плагина [PluginRSSURLRewrite RSSURLRewrite]).

===Отключение рассылки===

Для отключения рассылки просто щелкните по ней правой кнопкой в списке категорий и выберите "Отключить рассылку". Если потребуется повторно активировать эту рассылку, просто щелкните ее еще раз правой кнопкой и выберите "Включить рассылку".

===Переименование рассылки===

Рассылку можно переименовать или изменить ее URL, щелкнув по ней один раз правой кнопкой мыши и выбрав "Правка рассылки".

===Просмотр RSS-рассылки===

Щелкните RSS-рассылку мышью для ее просмотра. Либо можно щелкнуть "Все рассылки". Все содержание, связанное с текущей рассылкой, будет показано в главном окне списка. 

[http://rutorrent.googlecode.com/svn/wiki/ru/images/PluginRSS/addrssresult.jpg]

По двойному щелчку на строке содержимого будет произведена попытка открытия соответствующего URL в браузере.

Для выбранного элемента на закладке "Общее" показывается описание элемента (если таковое есть).

Для RSS-рассылок существуют дополнительные информационные колонки. Для их включения/отключения щелкните правой кнопкой на названии любой колонки. Порядок расположения колонок можно изменять, перетаскивая их мышью. Эти параметры не зависят от колонок, доступных при просмотре загруженных торрентов.

===Ручная загрузка торрентов===

Для загрузки торента в ручном режиме можно воспользоваться соответствующим пунктом контекстного меню "Загрузить", после чего Вам будет показан диалог, по функциональности идентичный обычному [Usage#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D0%BA%D0%B0%D1%87%D0%B5%D0%BA диалогу добавления закачки].

[http://rutorrent.googlecode.com/svn/wiki/ru/images/PluginRSS/rssload.jpg]

===Использование рассылок, требующих HTTP-аутентификации===

Если рассылки требуют HTTP-аутентификации, просто используйте следующий формат при вводе их URL: 
{{{
http://логин:пароль@некий-торрент-сайт.com/rss.php
}}}

===Использование рассылок, требующих cookies===

Для использования рассылок, требующих cookies, нужно найти cookies для сайта и взять оттуда требуемые (обычно они называются uid и pass).

    * Файлы cookies в Internet Explorer находятся в `%UserProfile%\Cookies`.
    * Пользователи Firefox могут найти файлы cookies в меню `Tools (Инструменты) -> Options (Настройки) -> Privacy (Приватность) -> Show Cookies (Показать cookies)`
    * Пользователи Opera могут найти файлы cookies в меню `Инструменты (Tools) -> Расширенные (Advanced) -> Cookies`.
    * Пользователям других браузеров следует обратиться к документации своей программы.
После нахождения всей требуемой информации введите URL рассылки в следующем формате:
{{{
http://некий-торрент-сайт.com/rss.php:COOKIE:name1=value;name2=value;
}}}
Альтернативный метод проинформировать ruTorrent о требуемых cookies предоставляет плагин [PluginCookies Cookies].

===Автоматическая загрузка торрентов===	

Для автоматической загрузки торрентов Вы должны создать один или несколько фильтров.

    # Щелкните на любой рассылке правой кнопкой мыши и выберите в меню пункт "Менеджер рассылок". Откроется соотв. диалог.
    # Нажмите "Добавить", и введите в левой колонке имя добавляемого фильтра.
    # Введите содержимое фильтра в пункте Настройки фильтров -> Фильтр.

[http://rutorrent.googlecode.com/svn/wiki/ru/images/PluginRSS/rssdownloader.jpg]

Содержимое фильтра должно представлять собой Perl-совместимое регулярное выражение ([http://www.pcre.org/ PCRE]). С синтаксисом PCRE можно ознакомиться, например, [http://ru.php.net/manual/en/reference.pcre.pattern.syntax.php здесь] или [http://www.regular-expressions.info здесь].

Это минимальный набор действий, требуемых для настройки автоматической загрузки. Остальные функции являются дополнительными и позволяют более полно контролировать процесс.

    * *Кроме* - позволяет исключить определенные строки из совпадения. Например, Вам не нужны версии с AC3-звуком и кодеком H.264: в разделе "Кроме:" Вы можете написать {{{/(AC3|264)/i}}} для их исключения.
    * *Искать в названии*,*Искать в описании*,*Искать в ссылке* - с какими частями элемента рассылки будет производиться работа. Например, если выбрать все три пункта, то проверка фильтра будет вестись в строке, которая будет получена объединением названия, описания и ссылки на элемент через пробел. 
    * *Рассылка* - позволяет выбрать рассылку, для которой будет применяться данный фильтр.
    * *Директория* - позволяет выбрать директорию, в которую будут сохраняться торренты. 
    * *Не добавлять имя торрента к пути* - флаг имеет смысл для многофайловых закачек, его включение приведет к тому, что директория верхнего уровня закачки будет *заменена* на указанную Вами.
    * *Не начинать закачку автоматически* - используется для добавления всех загруженных торрентов в режиме "Остановлен". Загрузки будут добавлены в список, но скачивание начнется только после того, как Вы вручную запустите их в списке торрентов.
    * *Min интервал* - позволяет ограничить временной промежуток использования фильтра. Например, если выбрать пункт "1 день" то после первого срабатывания данный фильтр не будет проверяться в течение суток.
    * *Метка* - автоматическое назначение метки для торрентов, совпадающих с фильтром.
    * Для проверки параметров фильтра можно использовать кнопку "?". Если фильтр задан корректно, будет показано количество совпадений с ним в рассылке. Если нет - в логе ruTorrent Вы увидите соответствующее сообщение.
    * Вы можете временно отключить фильтр, не удаляя его из списка. Для этого достаточно убрать галку слева от имени фильтра.

== Как оно работает ==

После первой загрузки с установленным плагином RSS, ruTorrent выдает команду планировщику rTorrent, который, в свою очередь, начинает периодически опрашивать требуемые RSS-рассылки, сохраняя локальные копии их содержимого на диск. 
В процессе синхронизации он проверяет содержимое рассылок на предмет совпадения с имеющимися фильтрами. 
Если таковое имеется - соответствующие .torrent файлы передаются в rTorrent на обработку. 
Диагностика о неудачных загрузках и/или операциях синхронизации будет показана в окне лога ruTorrent при следующей загрузке последнего.

Еще раз обращаю внимание - процесс опроса начинается только после первой загрузки ruTorrent. Т.е. в промежуток между стартом rTorrent и первым после этого стартом ruTorrent никакой полезной работы производиться не будет. Чтобы избежать этого, нужно добавить в конфигурационный файл rTorrent [Plugins#%D0%90%D0%B2%D1%82%D0%BE%D1%81%D1%82%D0%B0%D1%80%D1%82_%D0%BF%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD%D0%BE%D0%B2 специально обученную строчку].

== Дополнительная настройка плагина ==

Вплоть до версии 3.5 производится в файле `plugins/rss/conf.php`.
    * `$updateInterval` - переменная содержит интервал синхронизации локальных копий RSS-рассылок (в минутах). По умолчанию - 30 минут.
Начиная с версии 3.5 интервал синхронизации вынесен на интерфейс ruTorrent (см. пункт 'Рассылки' в диалоге настроек).
